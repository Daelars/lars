---
import type { FileData } from "../types"; // Assuming your type definition is in a 'types' file

// Server-side fetching (if possible)
const { files: initialFiles } = await Astro.glob("./content/**/*.md"); // Adjust the path if needed
---

<html>
  <head>
    <title>Markdown Files</title>
  </head>
  <body>
    <h1>Markdown Files</h1>

    <script>
      // Client-side state to hold all files
      let files = initialFiles;

      // Client-side fetch logic
      const fetchMarkdownFiles = async () => {
        const response = await fetch(
          new URL("/api/markdown", window.origin).toString()
        );
        const { files: updatedFiles } = await response.json();
        files = updatedFiles; // Update local state
      };

      // Call fetch on page load
      fetchMarkdownFiles();
    </script>

    <ul>
      {
        files.map((file) => (
          <li key={file.name}>
            <h2>{file.name}</h2>
            <div set:html={file.content} />
          </li>
        ))
      }
    </ul>
  </body>
</html>
