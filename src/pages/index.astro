---
// src/pages/index.astro
// Convert Astro.request.url to a URL object if it's not already one
const response = await fetch(`${requestUrl.origin}/api/files`);
const text = await response.text(); // Temporarily get the response as text
console.log(text); // Check if it's JSON or an unexpected HTML response
let data;
try {
  data = JSON.parse(text); // Attempt to parse it as JSON
} catch (error) {
  console.error("Error parsing JSON:", error);
  // Handle the error or set a fallback for `data`
  data = {}; // Set to a default value or handle accordingly
}
---

<html>
  <head>
    <title>Files List</title>
  </head>
  <body>
    <h1>Files</h1>
    <ul>
      {data.files?.map((file) => <li>{file.name}</li>)}
    </ul>
  </body>
</html>
